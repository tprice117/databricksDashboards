document.addEventListener("DOMContentLoaded",function(){function n(){a.style.display="none",i.style.borderRadius="0.85rem"}function e(){a.style.display="block",i.style.borderRadius="0.85rem 0.85rem 0px 0px"}function t(t){p=0,t?(d.style.display="block",fetch(`https://api.trydownstream.com/explore/v1/search/?q=${encodeURIComponent(t)}`).then(n=>n.json()).then(t=>{c.innerHTML="",s.innerHTML="",e();const o=document.createElement("ul");if(o.classList.add("results-list"),!t||t.errors)return void n();if(!(t&&t.main_products&&t.main_product_categories&&t.main_product_category_groups)){const n=document.createElement("li");return n.textContent="No results found",o.appendChild(n),void c.appendChild(o)}t.main_products,t.main_product_categories,t.main_product_category_groups;p=t.main_products.length+t.main_product_categories.length+t.main_product_category_groups.length,t.main_product_categories.forEach(n=>{const e=document.createElement("li"),r=document.createElement("a"),i=document.createElement("img"),d=document.createElement("span");d.textContent=`Category: ${n.name}`,r.href=`https://portal.trydownstream.com/customer/order/new/product/${n.id}`,i.src=n.icon,r.appendChild(i),r.appendChild(d),e.appendChild(r),o.appendChild(e);const a=t.main_products.filter(e=>e.main_product_category===n.id);a.forEach(e=>{const t=document.createElement("li");t.style.paddingLeft="40px";const r=document.createElement("a"),i=document.createElement("img"),d=document.createElement("span");r.href=`https://portal.trydownstream.com/customer/order/new/options/${e.id}`,e.images.length>0?i.src=e.images[0]:i.src=n.icon,d.textContent=`${e.name}`,r.appendChild(i),r.appendChild(d),t.appendChild(r),o.appendChild(t)})}),t.main_product_category_groups.forEach(n=>{const e=document.createElement("li"),t=document.createElement("a"),r=document.createElement("img"),i=document.createElement("span");i.textContent=`All ${n.name}`,t.href=`https://portal.trydownstream.com/customer/order/new/?q=&group_id=${n.id}`,r.src=n.icon,t.appendChild(r),t.appendChild(i),e.appendChild(t),o.appendChild(e)}),c.appendChild(o),s.innerHTML="";const r=document.createElement("span");r.classList.add("results-count"),r.textContent=`Showing ${p} results`,s.appendChild(r)}).catch(n=>console.error("Error:",n)).finally(()=>{d.style.display="none"})):n()}const o=document.createElement("style");o.innerHTML="\n        .search-form {\n            display: flex;\n            justify-content: center;\n        }\n        .dropdown {\n            position: relative;\n            width: 600px;\n            margin-top: 20px;\n        }\n\n        @media(max-width: 650px) {\n            .dropdown {\n                width: 100%;\n            }\n        }\n\n        .search-input {\n            display: block;\n            width: 100%;\n            min-width: 300px;\n            padding: .575rem .85rem;\n            margin: 0;\n            font-family: inherit;\n            font-size: 1.25rem;\n            font-weight: 400;\n            line-height: 1.75;\n            color: #858796;\n            -webkit-appearance: none;\n            -moz-appearance: none;\n            appearance: none;\n            background-color: #fff;\n            background-clip: padding-box;\n            border: 1px solid #858796;\n            border-radius: 0.85rem;\n            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;\n            -webkit-appearance: textfield;\n            outline-offset: -2px;\n        }\n\n        .search-input:focus {\n            color: #858796;\n            background-color: #fff;\n            border-color: #a7b9ef;\n            outline: 0;\n            box-shadow: 0 0 0 .15rem rgba(78, 115, 223, .25);\n        }\n\n\n        .dropdown-content {\n            display: none;\n            position: absolute;\n            background-color: #f1f1f1;\n            background-color: #fff;\n            margin-bottom: 3rem;\n            min-width: 160px;\n            width: 100%;\n            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);\n            z-index: 5;\n            border-bottom: 1px solid #ccc;\n        }\n\n        .dropdown-content div {\n            color: black;\n            padding: 12px 16px;\n            text-decoration: none;\n            display: block;\n            cursor: pointer;\n        }\n        .spinner {\n            display: None;\n            width: 20px;\n            height: 20px;\n            border: 3px solid #f3f3f3;\n            border-top: 3px solid #3498db;\n            border-radius: 50%;\n            animation: spin 1s linear infinite;\n            position: absolute;\n            right: 40px;\n            top: 30%;\n        }\n\n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n\n        .results-list {\n            list-style-type: none;\n            padding: 0;\n            margin: 0;\n            max-height: 400px;\n            overflow-y: auto;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            background-color: #fff;\n            position: relative;\n            width: 100%;\n            \n        }\n        .results-list li {\n            padding: 10px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            border-bottom: 1px solid #ccc;\n        }\n\n        .results-list li img {\n            width: 50px;\n            height: 50px;\n            margin-right: 10px;\n        }\n\n        .results-list li:hover {\n            background-color: #f0f0f0;\n        }\n\n        .pagination {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            margin: 10px;\n        }\n\n        .pagination button {\n            margin: 0 5px;\n            padding: 5px 10px;\n            cursor: pointer;\n        }\n\n        .pagination button:disabled {\n            cursor: not-allowed;\n            opacity: 0.5;\n        }\n\n        .results-count {\n        }\n    ",document.head.appendChild(o);const r=document.querySelector(".search-form");if(!r)return void console.error("Element with class search-form not found");{const n=document.createElement("div");n.classList.add("dropdown");const e=document.createElement("input");e.id="searchQuery",e.classList.add("search-input"),e.setAttribute("autocomplete","off"),e.setAttribute("type","search"),e.setAttribute("name","q"),e.setAttribute("placeholder","Search Downstream Marketplace"),e.setAttribute("required","true");const t=document.createElement("div");t.classList.add("spinner"),t.id="spinner";const o=document.createElement("div");o.classList.add("dropdown-content"),o.id="results-container";const i=document.createElement("div");i.id="results";const d=document.createElement("div");d.id="pagination",d.classList.add("pagination"),o.appendChild(i),o.appendChild(d),n.appendChild(e),n.appendChild(t),n.appendChild(o),r.appendChild(n)}document.getElementById("searchForm");const i=document.getElementById("searchQuery"),d=document.getElementById("spinner"),a=document.getElementById("results-container"),c=document.getElementById("results"),s=document.getElementById("pagination");let p=0;let l;i.addEventListener("focus",function(){p>0&&e()}),document.addEventListener("click",function(e){a.contains(e.target)||i.contains(e.target)||n()}),i.addEventListener("input",function(n){clearTimeout(l),l=setTimeout(function(){if(!i.value||i.value.length>2){const n=i.value;console.log("query",n),t(n)}},500)})});