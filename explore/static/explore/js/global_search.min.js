document.addEventListener("DOMContentLoaded",function(){function n(n){if(!n)return d.style.display="none",void(o.style.borderRadius="0.35rem");r.style.display="block",o.style.borderRadius="0.35rem 0.35rem 0px 0px",fetch(`https://api.trydownstream.com/explore/v1/search/?q=${encodeURIComponent(n)}`).then(n=>n.json()).then(n=>{i.innerHTML="",a.innerHTML="",d.style.display="block";const e=document.createElement("ul");if(e.classList.add("results-list"),!n||n.errors)return d.style.display="none",void(o.style.borderRadius="0.35rem");if(!(n&&n.main_products&&n.main_product_categories&&n.main_product_category_groups)){const n=document.createElement("li");return n.textContent="No results found",e.appendChild(n),void i.appendChild(e)}n.main_products,n.main_product_categories,n.main_product_category_groups;const t=n.main_products.length+n.main_product_categories.length+n.main_product_category_groups.length;n.main_product_categories.forEach(t=>{const o=document.createElement("li"),r=document.createElement("a"),d=document.createElement("img"),i=document.createElement("span");t.group?(i.textContent=`Category: ${t.name}`,r.href=`https://portal.trydownstream.com/customer/order/new/?q=&group_id=${t.group}`):(i.textContent=`Category Group: ${t.name}`,r.href=`https://portal.trydownstream.com/customer/order/new/?q=&group_id=${t.id}`),d.src=t.icon,r.appendChild(d),r.appendChild(i),o.appendChild(r),e.appendChild(o);const a=n.main_products.filter(n=>n.main_product_category===t.id);a.forEach(n=>{const o=document.createElement("li");o.style.paddingLeft="40px";const r=document.createElement("a"),d=document.createElement("img"),i=document.createElement("span");r.href=`https://portal.trydownstream.com/customer/order/new/product/${n.main_product_category}`,n.images.length>0?d.src=n.images[0]:d.src=t.icon,i.textContent=`Product: ${n.name}`,r.appendChild(d),r.appendChild(i),o.appendChild(r),e.appendChild(o)})}),n.main_product_category_groups.forEach(n=>{const t=document.createElement("li"),o=document.createElement("a"),r=document.createElement("img"),d=document.createElement("span");d.textContent=`Category Group: ${n.name}`,o.href=`https://portal.trydownstream.com/customer/order/new/?q=&group_id=${n.id}`,r.src=n.icon,o.appendChild(r),o.appendChild(d),t.appendChild(o),e.appendChild(t)}),i.appendChild(e),a.innerHTML="";const r=document.createElement("span");r.classList.add("results-count"),r.textContent=`Showing ${t} results`,a.appendChild(r)}).catch(n=>console.error("Error:",n)).finally(()=>{r.style.display="none"})}const e=document.createElement("style");e.innerHTML="\n        .dropdown {\n            position: relative;\n            width: 600px;\n        }\n\n        @media(max-width: 650px) {\n            .dropdown {\n                width: 100%;\n            }\n        }\n\n        .search-input {\n            display: block;\n            width: 100%;\n            min-width: 300px;\n            padding: .375rem .75rem;\n            margin: 0;\n            font-family: inherit;\n            font-size: 1rem;\n            font-weight: 400;\n            line-height: 1.5;\n            color: #858796;\n            -webkit-appearance: none;\n            -moz-appearance: none;\n            appearance: none;\n            background-color: #fff;\n            background-clip: padding-box;\n            border: 1px solid #858796;\n            border-radius: 0.35rem;\n            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;\n            -webkit-appearance: textfield;\n            outline-offset: -2px;\n        }\n\n        .search-input:focus {\n            color: #858796;\n            background-color: #fff;\n            border-color: #a7b9ef;\n            outline: 0;\n            box-shadow: 0 0 0 .15rem rgba(78, 115, 223, .25);\n        }\n\n\n        .dropdown-content {\n            display: none;\n            position: absolute;\n            background-color: #f1f1f1;\n            background-color: #fff;\n            margin-bottom: 3rem;\n            min-width: 160px;\n            width: 100%;\n            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);\n            z-index: 1;\n            border-bottom: 1px solid #ccc;\n        }\n\n        .dropdown-content div {\n            color: black;\n            padding: 12px 16px;\n            text-decoration: none;\n            display: block;\n            cursor: pointer;\n        }\n        .spinner {\n            display: none;\n            width: 20px;\n            height: 20px;\n            border: 3px solid #f3f3f3;\n            border-top: 3px solid #3498db;\n            border-radius: 50%;\n            animation: spin 1s linear infinite;\n            position: absolute;\n            right: 40px;\n            top: 5px;\n        }\n\n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n\n        .results-list {\n            list-style-type: none;\n            padding: 0;\n            margin: 0;\n            max-height: 400px;\n            overflow-y: auto;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            background-color: #fff;\n            position: relative;\n            width: 100%;\n            \n        }\n        .results-list li {\n            padding: 10px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            border-bottom: 1px solid #ccc;\n        }\n\n        .results-list li img {\n            width: 50px;\n            height: 50px;\n            margin-right: 10px;\n        }\n\n        .results-list li:hover {\n            background-color: #f0f0f0;\n        }\n\n        .pagination {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            margin: 10px;\n        }\n\n        .pagination button {\n            margin: 0 5px;\n            padding: 5px 10px;\n            cursor: pointer;\n        }\n\n        .pagination button:disabled {\n            cursor: not-allowed;\n            opacity: 0.5;\n        }\n\n        .results-count {\n        }\n    ",document.head.appendChild(e);const t=document.querySelector(".search-form");if(!t)return void console.error("Element with class search-form not found");{const n=document.createElement("div");n.classList.add("dropdown");const e=document.createElement("input");e.id="searchQuery",e.classList.add("search-input"),e.setAttribute("autocomplete","off"),e.setAttribute("type","search"),e.setAttribute("name","q"),e.setAttribute("placeholder","Search Downstream Marketplace"),e.setAttribute("required","true");const o=document.createElement("div");o.classList.add("spinner"),o.id="spinner";const r=document.createElement("div");r.classList.add("dropdown-content"),r.id="results-container",r.style.zIndex="5";const d=document.createElement("div");d.id="results";const i=document.createElement("div");i.id="pagination",i.classList.add("pagination"),r.appendChild(d),r.appendChild(i),n.appendChild(e),n.appendChild(o),n.appendChild(r),t.appendChild(n)}document.getElementById("searchForm");const o=document.getElementById("searchQuery"),r=document.getElementById("spinner"),d=document.getElementById("results-container"),i=document.getElementById("results"),a=document.getElementById("pagination");let c;o.addEventListener("input",function(e){clearTimeout(c),c=setTimeout(function(){if(!o.value||o.value.length>2){const e=o.value;console.log("query",e),n(e)}},500)})});