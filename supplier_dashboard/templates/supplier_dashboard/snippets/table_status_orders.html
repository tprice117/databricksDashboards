{% load static %}
<tbody id="booking-results" hx-disabled-elt=".status-card, button">
    {% for order in status.orders %}
    <tr id="order_row_{{forloop.counter}}">
        <td>{{order.end_date}}</td>
        <td>{{order.order_group.seller_product_seller_location.seller_product.product.main_product.name}}
        </td>
        <td>{{order.order_group.user_address.formatted_address}}</td>
        <td>{{order.order_type}}</td>
        <td class="order-status-td">{{order.status}}</td>
        {% if order.status == "PENDING" %}
        <td>
            <span id="accept-button-container">
                <!-- TODO: Look at using Bootstrap modal -->
                <!-- <button class="btn btn-success" type="button" data-bs-target="#modal-1"
                    data-bs-toggle="modal">Accept</button> -->
                <button type="button" class="btn btn-primary accept-button"
                    hx-post="{% url 'supplier_order_accept' order_id=order.id %}"
                    hx-vals='{"loopcount": "{{forloop.counter}}", "queryParams": "{{ request.GET.urlencode }}"}'
                    hx-swap="outerHTML" hx-target="#order_row_{{forloop.counter}}"
                    hx-indicator="#htmx-indicator{{forloop.counter}}" hx-trigger='confirmed' onClick="Swal.fire(
                        {title: 'Accept Booking', text:'You can fulfill this booking on the date and location listed.', icon: 'question', confirmButtonText: 'Confirm'}).then((result)=>{
                            if(result.isConfirmed){htmx.trigger(this, 'confirmed');}})">
                    Accept
                    <span class="htmx-indicator" id="htmx-indicator{{forloop.counter}}">
                        <img class="svg-loader" src="{% static 'supplier_dashboard/svg-loaders/bars.svg' %}" />
                    </span>
                </button>
            </span>
        </td>
        {% elif order.is_past_due and order.status == "SCHEDULED" %}
        <td>
            <span id="accept-button-container">
                <button type="button" class="btn btn-primary complete-button"
                    hx-post="{% url 'supplier_order_complete' order_id=order.id %}"
                    hx-vals='{"loopcount": "{{forloop.counter}}", "queryParams": "{{ request.GET.urlencode }}"}'
                    hx-swap="outerHTML" hx-target="#order_row_{{forloop.counter}}"
                    hx-indicator="#htmx-indicator{{forloop.counter}}" hx-trigger='confirmed' onClick="Swal.fire(
                        {title: 'Complete Booking', text:'Has this booking been completed?', icon: 'question', confirmButtonText: 'Confirm'}).then((result)=>{
                            if(result.isConfirmed){htmx.trigger(this, 'confirmed');}})">
                            Complete
                    <span class="htmx-indicator" id="htmx-indicator{{forloop.counter}}">
                        <img class="svg-loader" src="{% static 'supplier_dashboard/svg-loaders/bars.svg' %}" />
                    </span>
                </button>
            </span>
        </td>
        {% endif %}
        <td><a class="btn btn-light" role="button" href="{% url 'supplier_booking_detail' order_id=order.id %}"><i
                    class="far fa-eye"></i></a></td>
    </tr>
    {% endfor %}
</tbody>